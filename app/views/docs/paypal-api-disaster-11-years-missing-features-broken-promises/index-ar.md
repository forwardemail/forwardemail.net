# كارثة واجهة برمجة التطبيقات (API) الخاصة بـ PayPal والتي استمرت لمدة 11 عامًا: كيف قمنا ببناء حلول بديلة بينما تجاهلوا المطورين {#paypals-11-year-api-disaster-how-we-built-workarounds-while-they-ignored-developers}

<img loading="lazy" src="/img/articles/pypl-disaster.webp" alt="PayPal API disaster illustration" class="rounded-lg" />

<p class="lead mt-3">في Forward Email، نتعامل مع واجهات برمجة تطبيقات PayPal المعطوبة منذ أكثر من عقد. ما بدأ كإحباطات بسيطة تحول إلى كارثة حقيقية أجبرتنا على بناء حلول بديلة، وحظر قوالب التصيد الاحتيالي الخاصة بهم، وفي النهاية إيقاف جميع مدفوعات PayPal أثناء عملية نقل حساب مهمة.</p>
<p class="lead mt-3">هذه قصة 11 عامًا من تجاهل PayPal لاحتياجات المطورين الأساسية بينما كنا نبذل قصارى جهدنا لجعل منصتهم تعمل.</p>

## جدول المحتويات {#table-of-contents}

* [الجزء المفقود: لا توجد طريقة لإدراج الاشتراكات](#the-missing-piece-no-way-to-list-subscriptions)
* [2014-2017: ظهور المشكلة](#2014-2017-the-problem-emerges)
* [2020: نقدم لهم تعليقات شاملة](#2020-we-give-them-extensive-feedback)
  * [قائمة التعليقات المكونة من 27 عنصرًا](#the-27-item-feedback-list)
  * [شاركت الفرق، وتم تقديم الوعود](#teams-got-involved-promises-were-made)
  * [النتيجة؟ لا شيء.](#the-result-nothing)
* [هجرة المديرين التنفيذيين: كيف فقدت باي بال كل ذاكرتها المؤسسية](#the-executive-exodus-how-paypal-lost-all-institutional-memory)
* [2025: قيادة جديدة، نفس المشاكل](#2025-new-leadership-same-problems)
  * [الرئيس التنفيذي الجديد يتدخل](#the-new-ceo-gets-involved)
  * [رد ميشيل جيل](#michelle-gills-response)
  * [ردنا: لا مزيد من الاجتماعات](#our-response-no-more-meetings)
  * [استجابة مارتي برودبيك المفرطة في الهندسة](#marty-brodbecks-overengineering-response)
  * [تناقض "الفوضى البسيطة"](#the-simple-crud-contradiction)
  * [الانفصال أصبح واضحا](#the-disconnect-becomes-clear)
* [سنوات من تقارير الأخطاء التي تجاهلوها](#years-of-bug-reports-they-ignored)
  * [2016: شكاوى مبكرة بشأن واجهة المستخدم/تجربة المستخدم](#2016-early-uiux-complaints)
  * [2021: تقرير خطأ البريد الإلكتروني للأعمال](#2021-business-email-bug-report)
  * [2021: اقتراحات لتحسين واجهة المستخدم](#2021-ui-improvement-suggestions)
  * [2021: فشل بيئة Sandbox](#2021-sandbox-environment-failures)
  * [2021: نظام التقارير معطل تمامًا](#2021-reports-system-completely-broken)
  * [2022: ميزة واجهة برمجة التطبيقات الأساسية مفقودة (مرة أخرى)](#2022-core-api-feature-missing-again)
* [كابوس تجربة المطور](#the-developer-experience-nightmare)
  * [واجهة المستخدم معطلة](#broken-user-interface)
  * [مشاكل SDK](#sdk-problems)
  * [انتهاكات سياسة أمان المحتوى](#content-security-policy-violations)
  * [فوضى التوثيق](#documentation-chaos)
  * [الثغرات الأمنية](#security-vulnerabilities)
  * [كارثة إدارة الجلسة](#session-management-disaster)
* [يوليو 2025: القشة التي قصمت ظهر البعير](#july-2025-the-final-straw)
* [لماذا لا يمكننا التوقف عن استخدام PayPal](#why-we-cant-just-drop-paypal)
* [الحل المجتمعي](#the-community-workaround)
* [حظر قوالب PayPal بسبب التصيد الاحتيالي](#blocking-paypal-templates-due-to-phishing)
  * [المشكلة الحقيقية: قوالب PayPal تبدو وكأنها عمليات احتيال](#the-real-problem-paypals-templates-look-like-scams)
  * [تنفيذنا](#our-implementation)
  * [لماذا كان علينا حظر باي بال](#why-we-had-to-block-paypal)
  * [حجم المشكلة](#the-scale-of-the-problem)
  * [المفارقة](#the-irony)
  * [التأثير الحقيقي: عمليات احتيال جديدة على PayPal](#real-world-impact-novel-paypal-scams)
* [عملية KYC العكسية من PayPal](#paypals-backwards-kyc-process)
  * [كيف ينبغي أن يعمل](#how-it-should-work)
  * [كيف يعمل PayPal فعليًا](#how-paypal-actually-works)
  * [التأثير في العالم الحقيقي](#the-real-world-impact)
  * [كارثة هجرة الحسابات في يوليو 2025](#the-july-2025-account-migration-disaster)
  * [لماذا هذا مهم؟](#why-this-matters)
* [كيف تقوم كل معالجات الدفع الأخرى بذلك بشكل صحيح](#how-every-other-payment-processor-does-it-right)
  * [شريط](#stripe)
  * [مجداف](#paddle)
  * [كوين بيس كوميرس](#coinbase-commerce)
  * [مربع](#square)
  * [معيار الصناعة](#the-industry-standard)
  * [ما تقدمه المعالجات الأخرى مقابل PayPal](#what-other-processors-provide-vs-paypal)
* [التستر المنهجي من قِبل باي بال: إسكات 6 ملايين صوت](#paypals-systematic-cover-up-silencing-6-million-voices)
  * [المحو العظيم](#the-great-erasure)
  * [الإنقاذ من طرف ثالث](#the-third-party-rescue)
* [كارثة التقاط الأخطاء التي استمرت 11 عامًا: 1899 دولارًا وما زال العدد في ازدياد](#the-11-year-capture-bug-disaster-1899-and-counting)
  * [خسارة شركة Forward Email بقيمة 1899 دولارًا](#forward-emails-1899-loss)
  * [التقرير الأصلي لعام 2013: أكثر من 11 عامًا من الإهمال](#the-2013-original-report-11-years-of-negligence)
  * [اعتراف عام 2016: باي بال تُصدر مجموعة أدوات التطوير البرمجية الخاصة بها](#the-2016-admission-paypal-breaks-their-own-sdk)
  * [التصعيد في عام 2024: لا يزال مكسورًا](#the-2024-escalation-still-broken)
  * [كارثة موثوقية الويب هوك](#the-webhook-reliability-disaster)
  * [نمط الإهمال المنهجي](#the-pattern-of-systematic-negligence)
  * [المتطلب غير الموثق](#the-undocumented-requirement)
* [نمط الخداع الأوسع نطاقًا لدى PayPal](#paypals-broader-pattern-of-deception)
  * [إجراءات إدارة الخدمات المالية في نيويورك](#the-new-york-department-of-financial-services-action)
  * [دعوى العسل: إعادة صياغة الروابط التابعة](#the-honey-lawsuit-rewriting-affiliate-links)
  * [تكلفة إهمال باي بال](#the-cost-of-paypals-negligence)
  * [كذبة التوثيق](#the-documentation-lie)
* [ماذا يعني هذا للمطورين](#what-this-means-for-developers)

## القطعة المفقودة: لا توجد طريقة لإدراج الاشتراكات {#the-missing-piece-no-way-to-list-subscriptions}

إليك الأمر الذي أذهلنا: لقد كان لدى PayPal نظام الفوترة بالاشتراك منذ عام 2014، لكنهم لم يقدموا أبدًا طريقة للتجار لإدراج اشتراكاتهم الخاصة.

فكّر في هذا الأمر للحظة. يمكنك إنشاء اشتراكات وإلغاؤها إذا كان لديك المعرّف، ولكن لا يمكنك الحصول على قائمة بجميع الاشتراكات النشطة لحسابك. الأمر أشبه بوجود قاعدة بيانات بدون جملة SELECT.

نحن بحاجة إلى هذا لعمليات الأعمال الأساسية:

* دعم العملاء (عند إرسال بريد إلكتروني للاستفسار عن اشتراكك)
* إعداد التقارير المالية والمطابقة
* إدارة الفواتير الآلية
* الامتثال والتدقيق

لكن باي بال؟ لم يبنوها أبدًا.

## 2014-2017: ظهور المشكلة {#2014-2017-the-problem-emerges}

ظهرت مشكلة قائمة الاشتراكات لأول مرة في منتديات مجتمع PayPal في عام 2017. وكان المطورون يطرحون السؤال الواضح: "كيف أحصل على قائمة بجميع اشتراكاتي؟"

رد باي بال؟ الصراصير.

بدأ أعضاء المجتمع يشعرون بالإحباط:

"إغفال غريب جدًا إذا لم يتمكن التاجر من سرد جميع الاتفاقيات النشطة. في حال فقدان مُعرّف الاتفاقية، فهذا يعني أن المستخدم وحده هو من يمكنه إلغاء أو تعليق الاتفاقية." - leafspider

> "+1. لقد مرّت ثلاث سنوات تقريبًا." - laudukang (أي أن المشكلة موجودة منذ عام ٢٠١٤)

يُظهر ملف [منشور المجتمع الأصلي](https://web.archive.org/web/20201019142512/https://www.paypal-community.com/t5/REST-API-SDK/List-all-subscriptions/td-p/1147066) من عام ٢٠١٧ توسّل المطورين لهذه الوظيفة الأساسية. وكان ردّ باي بال هو أرشفة المستودع الذي كان الناس يُبلغون عن المشكلة فيه.

## 2020: نقدم لهم تعليقات شاملة {#2020-we-give-them-extensive-feedback}

في أكتوبر 2020، تواصلت باي بال معنا لعقد جلسة تقييم رسمية. لم تكن هذه مجرد محادثة عابرة، بل نظموا مكالمة عبر مايكروسوفت تيمز لمدة 45 دقيقة مع 8 مسؤولين تنفيذيين في باي بال، من بينهم سري شيفاناندا (المدير التقني)، وإدوين أوكي، وجيم ماجاتس، وجون كونزي، وآخرون.

### قائمة التعليقات المكونة من 27 عنصرًا {#the-27-item-feedback-list}

كنا مستعدين. بعد ست ساعات من محاولة التكامل مع واجهات برمجة التطبيقات الخاصة بهم، جمعنا ٢٧ مشكلة محددة. قال مارك ستيوارت من فريق PayPal Checkout:

مرحباً نيك، شكراً لمشاركتك معنا اليوم! أعتقد أن هذا سيكون حافزاً لنا للحصول على المزيد من الدعم والاستثمار لفريقنا لإصلاح هذه المشاكل. لقد كان من الصعب الحصول على تعليقات قيّمة مثل التي قدمتها لنا حتى الآن.

لم تكن ردود الفعل نظرية - بل جاءت من محاولات تكامل حقيقية:

1. **إنشاء رمز الوصول لا يعمل**:

إنشاء رمز الوصول لا يعمل. كما ينبغي أن يكون هناك أكثر من مجرد أمثلة cURL.

2. **لا توجد واجهة مستخدم ويب لإنشاء الاشتراك**:

كيف يُمكنك إنشاء اشتراكات دون الحاجة إلى استخدام cURL؟ يبدو أنه لا توجد واجهة مستخدم ويب للقيام بذلك (مثل Stripe).

وجد مارك ستيوارت أن مشكلة رمز الوصول مثيرة للقلق بشكل خاص:

لا نسمع عادةً عن مشكلات تتعلق بإنشاء رمز الوصول.

### شاركت الفرق، وتم تقديم الوعود {#teams-got-involved-promises-were-made}

مع اكتشافنا المزيد من المشاكل، واصلت باي بال إضافة المزيد من الفرق إلى المحادثة. انضم دارشان راجو من فريق واجهة مستخدم إدارة الاشتراكات وقال:

> أقرّ بوجود هذه الفجوة. سنتابع الأمر ونعالجه. شكرًا جزيلاً لملاحظاتك!

وقد تم وصف الجلسة بأنها تهدف إلى:

> جولة صريحة حول تجربتك

ل:

> جعل PayPal كما ينبغي أن يكون بالنسبة للمطورين.

### النتيجة؟ لا شيء. {#the-result-nothing}

وعلى الرغم من جلسة المراجعة الرسمية، والقائمة الموسعة المكونة من 27 بندًا، ومشاركة العديد من الفرق، والوعود بما يلي:

> المسار والعنوان

القضايا، لم يتم إصلاح أي شيء على الإطلاق.

## هجرة المديرين التنفيذيين: كيف فقدت PayPal كل الذاكرة المؤسسية {#the-executive-exodus-how-paypal-lost-all-institutional-memory}

هنا تبدأ الأمور المثيرة للاهتمام. جميع من تلقّى ملاحظاتنا لعام ٢٠٢٠ غادروا باي بال:

**تغييرات القيادة:**

* حامل مكان مؤقت ٠ (سبتمبر ٢٠٢٣)
* حامل مكان مؤقت ١ (يناير ٢٠٢٤)

**القادة الفنيون الذين قدموا وعودًا ثم رحلوا:**

* **مارك ستيوارت** (وعدنا بأن تكون الملاحظات "حافزًا") → [الآن في ريبل](https://www.linkedin.com/in/markstuartsf)
* **جيم ماجاتس** (خبير في باي بال منذ ١٨ عامًا) → [الرئيس التنفيذي لشركة MX](https://www.cnbc.com/2022/07/28/paypal-veteran-jim-magats-is-named-ceo-of-mx-the-startup-that-connects-banks-and-fintech-players.html) (٢٠٢٢)
* **جون كونزي** (نائب رئيس قسم المنتجات الاستهلاكية العالمية) → [متقاعد](https://www.linkedin.com/in/john-kunze-5724a86) (٢٠٢٣)
* **إدوين أوكي** (من آخر الأعضاء المتبقين) → [غادر للتو إلى ناسداك](https://www.linkedin.com/posts/edwinaoki_apparently-i-just-cant-stay-awaythe-day-activity-7289388518487793664-j8OZ) (يناير ٢٠٢٥)

لقد أصبح PayPal بمثابة باب دوار حيث يجمع المديرون التنفيذيون تعليقات المطورين، ويقدمون الوعود، ثم يغادرون إلى شركات أفضل مثل JPMorgan، وRipple، وشركات التكنولوجيا المالية الأخرى.

وهذا يوضح سبب كون استجابة مشكلة GitHub لعام 2025 تبدو منفصلة تمامًا عن تعليقاتنا لعام 2020 - فقد غادر كل من تلقى هذه التعليقات PayPal حرفيًا.

## 2025: قيادة جديدة، نفس المشاكل {#2025-new-leadership-same-problems}

بحلول عام ٢٠٢٥، يتكرر نفس النمط. بعد سنوات من عدم التقدم، تواصلت القيادة الجديدة لباي بال مع الجميع.

### الرئيس التنفيذي الجديد يشارك {#the-new-ceo-gets-involved}

في 30 يونيو 2025، تواصلنا مباشرةً مع الرئيس التنفيذي الجديد لشركة باي بال، أليكس كريس. وكان رده موجزًا:

مرحباً نيك، شكرًا لك على التواصل معنا وملاحظاتك. ميشيل (نسخة من الرسالة) على أتمّ الاستعداد للتعاون مع فريقها والعمل على حل هذه المشكلة معك. شكرًا -A

### رد ميشيل جيل {#michelle-gills-response}

ردت ميشيل جيل، نائب الرئيس التنفيذي والمدير العام للشركات الصغيرة والخدمات المالية:

شكرًا جزيلاً يا نيك، على نقل أليكس إلى مركز الاتصال المخفي. لقد بحثنا في الأمر منذ منشورك السابق. سنتصل بك قبل نهاية الأسبوع. هل يمكنك إرسال معلومات الاتصال بك ليتمكن أحد زملائي من التواصل معك؟ ميشيل

### ردنا: لا مزيد من الاجتماعات {#our-response-no-more-meetings}

رفضنا اجتماعًا آخر، موضحين إحباطنا:

شكراً لك. مع ذلك، لا أعتقد أن مجرد المشاركة في مكالمة هاتفية سيُجدي نفعاً. إليكم السبب... شاركتُ في مكالمة سابقة ولم تُسفر عن أي نتيجة. أهدرت أكثر من ساعتين من وقتي في التحدث مع الفريق بأكمله والقيادة ولم يُنجز شيء... كم هائل من رسائل البريد الإلكتروني المتبادلة. لم يُنجز شيء على الإطلاق. لم تُثمر الملاحظات. حاولتُ لسنوات أن أُنصت، ثم لم يُثمر أي شيء.

### استجابة الهندسة المفرطة لمارتي برودبيك {#marty-brodbecks-overengineering-response}

وبعد ذلك، تواصل معنا مارتي برودبيك، الذي يرأس قسم هندسة المستهلك في PayPal، قائلاً:

مرحباً نيك، أنا مارتي برودبيك. أتولى مسؤولية هندسة المستهلك في باي بال، وأقود تطوير واجهة برمجة التطبيقات (API) للشركة. هل يمكنك التواصل معي لمناقشة المشكلة التي تواجهها وكيف يمكننا مساعدتك؟

عندما شرحنا له الحاجة البسيطة لنقطة نهاية قائمة الاشتراك، كشف رده عن المشكلة بالضبط:

> شكرًا لك نيك، نحن بصدد إنشاء واجهة برمجة تطبيقات اشتراك واحدة مع مجموعة أدوات تطوير برمجيات كاملة (تدعم معالجة الأخطاء الكاملة، وتتبع الاشتراك القائم على الأحداث، ووقت تشغيل قوي)، حيث يتم أيضًا تقسيم الفواتير كواجهة برمجة تطبيقات منفصلة للتجار للانتقال إليها بدلاً من الاضطرار إلى التنسيق عبر نقاط نهاية متعددة للحصول على استجابة واحدة.

هذا النهج خاطئ تمامًا. لسنا بحاجة إلى أشهر من البنية المعقدة. نحتاج إلى نقطة نهاية REST بسيطة تُدرج الاشتراكات - وهو أمر كان من المفترض أن يكون موجودًا منذ عام ٢٠١٤.

```http
GET /v1/billing/subscriptions
Authorization: Bearer {access_token}
```

### تناقض "CRUD البسيط" {#the-simple-crud-contradiction}

عندما أشرنا إلى أن هذه وظيفة CRUD الأساسية التي كان ينبغي أن تكون موجودة منذ عام 2014، كان رد مارتي واضحًا:

> عمليات Crud البسيطة هي جزء من واجهة برمجة التطبيقات الأساسية يا صديقي، لذا لن يستغرق الأمر شهورًا من التطوير

تُظهر مجموعة أدوات تطوير البرامج PayPal TypeScript، التي تدعم حاليًا ثلاث نقاط نهاية فقط بعد أشهر من التطوير، إلى جانب الجدول الزمني التاريخي، بوضوح أن مثل هذه المشاريع تتطلب أكثر من بضعة أشهر لإكمالها.

يُظهر هذا الرد أنه لا يفهم واجهة برمجة التطبيقات الخاصة به. إذا كانت "عمليات CRUD البسيطة جزءًا من واجهة برمجة التطبيقات الأساسية"، فأين نقطة نهاية قائمة الاشتراك؟ أجبنا:

إذا كانت "عمليات CRUD البسيطة جزءًا من واجهة برمجة التطبيقات الأساسية"، فأين نقطة نهاية قائمة الاشتراك؟ يطالب المطورون بهذه "عملية CRUD البسيطة" منذ عام ٢٠١٤. أي منذ أحد عشر عامًا. جميع معالجات الدفع الأخرى تتمتع بهذه الوظيفة الأساسية منذ اليوم الأول.

### أصبح الانفصال واضحًا {#the-disconnect-becomes-clear}

وتُظهِر المبادلات التي جرت في عام 2025 مع أليكس كريس، وميشيل جيل، ومارتي برودبيك نفس الخلل التنظيمي:

١. **القيادة الجديدة لا تملك علمًا بجلسات التقييم السابقة**
٢. **يقترحون نفس الحلول المُصممة بشكل مبالغ فيه**
٣. **لا يفهمون قيود واجهة برمجة التطبيقات الخاصة بهم**
٤. **يريدون المزيد من الاجتماعات بدلًا من مجرد حل المشكلة**

يوضح هذا النمط سبب انفصال فرق PayPal في عام 2025 تمامًا عن التعليقات الواسعة النطاق المقدمة في عام 2020 - فالأشخاص الذين تلقوا تلك التعليقات قد رحلوا، والقيادة الجديدة تكرر نفس الأخطاء.

## سنوات من تقارير الأخطاء التي تجاهلوها {#years-of-bug-reports-they-ignored}

لم نكتفِ بالشكوى من نقص الميزات، بل أبلغنا بنشاط عن الأخطاء وحاولنا تحسينها. إليكم جدول زمني شامل للمشكلات التي وثقناها:

### 2016: شكاوى مبكرة حول واجهة المستخدم/تجربة المستخدم {#2016-early-uiux-complaints}

حتى في عام ٢٠١٦، تواصلنا علنًا مع إدارة باي بال، بمن فيهم دان شولمان، بشأن مشاكل في واجهة المستخدم وسهولة الاستخدام. كان ذلك قبل تسع سنوات، ولا تزال نفس مشاكل واجهة المستخدم وتجربة المستخدم قائمة حتى اليوم.

### 2021: تقرير خطأ البريد الإلكتروني الخاص بالعمل {#2021-business-email-bug-report}

في مارس 2021، أبلغنا أن نظام البريد الإلكتروني التجاري الخاص بـ PayPal كان يرسل إشعارات إلغاء غير صحيحة. احتوى قالب البريد الإلكتروني على متغيرات غير صحيحة، مما أدى إلى ظهور رسائل مُربكة للعملاء.

اعترف مارك ستيوارت بهذه المشكلة:

شكرًا نيك! ننتقل إلى BCC. @Prasy، هل فريقك مسؤول عن هذا البريد الإلكتروني، أم تعرف من هو؟ رسالة "Niftylettuce, LLC، لن نرسل لك فاتورة بعد الآن" تجعلني أعتقد أن هناك خلطًا بين الجهة الموجهة إليها الرسالة ومحتوى الرسالة.

**النتيجة**: لقد أصلحوا هذه المشكلة بالفعل! أكد مارك ستيوارت:

علمنا للتو من فريق الإشعارات أن قالب البريد الإلكتروني قد تم إصلاحه وتم إطلاقه. نشكر تواصلكم معنا للإبلاغ عن المشكلة. شكرًا لكم!

يُظهر هذا أنهم قادرون على إصلاح الأمور عندما يريدون ذلك - لكنهم يختارون فقط عدم القيام بذلك في معظم المشكلات.

### 2021: اقتراحات لتحسين واجهة المستخدم {#2021-ui-improvement-suggestions}

في فبراير 2021، قدمنا تعليقات مفصلة حول واجهة المستخدم الخاصة بلوحة المعلومات الخاصة بهم، وتحديدًا قسم "النشاط الأخير على PayPal":

أعتقد أن لوحة التحكم في موقع paypal.com، وتحديدًا "أنشطة PayPal الأخيرة"، بحاجة إلى تحسين. لا أعتقد أنه يجب عرض حالة "تم الإنشاء" للدفعة المتكررة بقيمة 0 دولار أمريكي - فهذا يُضيف الكثير من الأسطر الإضافية، ولا يُمكنك بسهولة معرفة مقدار الدخل المُدرّ خلال اليوم/الأيام القليلة الماضية.

أرسل مارك ستيوارت الأمر إلى فريق المنتجات الاستهلاكية:

شكرًا! لست متأكدًا من الفريق المسؤول عن النشاط، لكنني أحلت الأمر إلى رئيس قسم منتجات المستهلك للعثور على الفريق المناسب. يبدو أن الدفعة المتكررة بقيمة 0.00 دولار أمريكي هي خلل. ربما يجب استبعادها.

**النتيجة**: لم يتم إصلاح المشكلة. لا تزال واجهة المستخدم تعرض إدخالات $0 عديمة الفائدة.

### 2021: فشل بيئة الحماية {#2021-sandbox-environment-failures}

في نوفمبر 2021، أبلغنا عن مشكلات حرجة تتعلق ببيئة Sandbox الخاصة بـ PayPal:

* تم تغيير مفاتيح API السرية لـ Sandbox بشكل عشوائي وتعطيلها.
* تم حذف جميع حسابات اختبار Sandbox دون إشعار.
* ظهرت رسائل خطأ عند محاولة عرض تفاصيل حساب Sandbox.
* حدثت أعطال متقطعة في التحميل.

لسببٍ ما، تم تغيير مفتاح API السري الخاص بصندوق الحماية الخاص بي، وتم تعطيله. كما تم حذف جميع حسابات اختبار صندوق الحماية القديمة الخاصة بي.

أحيانًا يتم تحميلها، وأحيانًا لا يتم تحميلها. هذا مُحبطٌ للغاية.

**النتيجة**: لا استجابة، لا حل. لا يزال المطورون يواجهون مشاكل في موثوقية بيئة الحماية.

### 2021: نظام التقارير معطل تمامًا {#2021-reports-system-completely-broken}

في مايو 2021، أبلغنا أن نظام التنزيل الخاص بتقارير المعاملات الخاص بـ PayPal كان معطلاً تمامًا:

يبدو أن الإبلاغ عن التنزيلات لا يعمل حاليًا، ولم يعمل طوال اليوم. يُفترض أيضًا أن تتلقى إشعارًا عبر البريد الإلكتروني في حال فشله.

لقد أشرنا أيضًا إلى كارثة إدارة الجلسة:

حتى إذا كنتَ غير نشط أثناء تسجيل دخولك إلى باي بال لمدة 5 دقائق تقريبًا، فسيتم تسجيل خروجك. لذا، عند تحديث الزر مرة أخرى بجوار التقرير الذي تريد التحقق من حالته (بعد انتظار طويل)، يصبح تسجيل الدخول مجددًا أمرًا مزعجًا.

أقر مارك ستيوارت بوجود مشكلة انتهاء مهلة الجلسة:

> أتذكر أنك ذكرت أنه في الماضي كانت جلستك تنتهي بشكل متكرر وتعطل تدفق التطوير الخاص بك أثناء التبديل بين IDE الخاص بك وdeveloper.paypal.com أو لوحة معلومات التاجر الخاصة بك، ثم تعود وتسجل الخروج مرة أخرى.

**النتيجة**: لا تزال مهلة الجلسة ٦٠ ثانية. نظام التقارير لا يزال يتعطل بانتظام.

### 2022: ميزة واجهة برمجة التطبيقات الأساسية مفقودة (مرة أخرى) {#2022-core-api-feature-missing-again}

في يناير 2022، قمنا بتصعيد مشكلة قائمة الاشتراك مرة أخرى، وهذه المرة بمزيد من التفاصيل حول كيفية وجود خطأ في وثائقهم:

> لا يوجد GET الذي يسرد جميع الاشتراكات (التي كانت تسمى سابقًا اتفاقيات الفوترة)

اكتشفنا أن وثائقهم الرسمية غير دقيقة تمامًا:

وثائق واجهة برمجة التطبيقات (API) غير دقيقة تمامًا. ظننا أنه يمكننا إيجاد حل بديل بتنزيل قائمة مُبرمجة مسبقًا بمعرفات الاشتراك، لكن هذا لم يُجدِ نفعًا!

> من الوثائق الرسمية هنا... تقول أنه يمكنك القيام بذلك... إليك المفاجأة - لا يوجد حقل "معرف الاشتراك" على الإطلاق في أي مكان يمكن العثور عليه ليتم التحقق منه.

ردت كريستينا مونتي من باي بال:

> نعتذر عن الإحباط الناتج عن كون هذه الخطوات خاطئة، وسوف نقوم بإصلاح ذلك هذا الأسبوع.

شكرنا سري شيفاناندا (CTO):

شكرًا جزيلًا على مساعدتكم المتواصلة في تحسين خدماتنا. نقدّر ذلك كثيرًا.

**النتيجة**: لم يتم إصلاح التوثيق. لم يتم إنشاء نقطة نهاية قائمة الاشتراك.

## كابوس تجربة المطور {#the-developer-experience-nightmare}

العمل مع واجهات برمجة تطبيقات PayPal أشبه بالعودة بالزمن عشر سنوات. إليك المشاكل التقنية التي وثقناها:

### واجهة المستخدم معطلة {#broken-user-interface}

لوحة معلومات مطوري باي بال كارثية. إليكم ما نتعامل معه يوميًا:

<figure>
<figcaption><div class="alert alert-danger small text-center">

واجهة مستخدم باي بال معطلة للغاية، لدرجة أنك لا تستطيع حتى تجاهل الإشعارات.
</div></figcaption>
<video class="lazyframe-bordered" loading="lazy" controls>
<source src="/img/articles/pypl-notifications.mp4" type="video/mp4">

متصفحك لا يدعم وسم الفيديو.
</video>
</figure>

<figure>
<figcaption><div class="alert alert-danger small text-center">
لوحة تحكم المطور تُجبرك حرفيًا على سحب شريط تمرير ثم تُسجل خروجك بعد 60 ثانية.
</div></figcaption>
<video class="lazyframe-bordered" loading="lazy" controls>
<source src="/img/articles/pypl-kapture-1.mp4" type="video/mp4">
متصفحك لا يدعم وسم الفيديو.
</video>
</figure>

<figure>
<figcaption><div class="alert alert-danger small text-center">
المزيد من مشاكل واجهة المستخدم في واجهة مطوري PayPal تُظهر سير عمل معطلاً.
</div></figcaption>
<video class="lazyframe-bordered" loading="lazy" controls>
<source src="/img/articles/pypl-kapture-2.mp4" type="video/mp4">
متصفحك لا يدعم وسم الفيديو.
</video>
</figure>

<figure>
<figcaption><div class="alert alert-danger small text-center">

واجهة إدارة الاشتراكات - الواجهة سيئة للغاية لدرجة أننا اضطررنا للاعتماد على الكود لإنشاء المنتجات وخطط الاشتراك.
</div></figcaption>
<img loading="lazy" src="/img/articles/pypl-subscriptions.png" alt="PayPal subscriptions screenshot" class="rounded-lg" />
</figure>

<figure>
<figcaption><div class="alert alert-danger small text-center">

صورة لواجهة الاشتراك المعطلة مع فقدان بعض الوظائف (لا يمكنك بسهولة إنشاء منتجات/خطط/اشتراكات - ولا يبدو أن هناك طريقة لحذف المنتجات أو الخطط بعد إنشائها في واجهة المستخدم)
</div></figcaption>
<img loading="lazy" src="/img/articles/pypl-subscriptions-2.png" alt="PayPal subscriptions screenshot 2" class="rounded-lg" />
</figure>

<figure>
<figcaption><div class="alert alert-danger small text-center">
رسائل خطأ باي بال الشائعة - غامضة وغير مفيدة
</div></figcaption>
<img loading="lazy" src="/img/articles/pypl-errors.png" alt="PayPal API error screenshot" class="rounded-lg" />
</figure>

### مشاكل SDK {#sdk-problems}

* لا يمكن التعامل مع الدفعات لمرة واحدة والاشتراكات دون حلول بديلة معقدة تتضمن تبديل الأزرار وإعادة عرضها أثناء إعادة تحميل حزمة تطوير البرامج (SDK) باستخدام وسوم البرامج النصية.
* تنتهك حزمة تطوير برامج JavaScript المعايير الأساسية (أسماء الفئات بأحرف صغيرة، وعدم التحقق من المثيلات).
* لا تشير رسائل الخطأ إلى الحقول المفقودة.
* أنواع بيانات غير متسقة (تتطلب كميات نصية بدلاً من أرقام).

### انتهاكات سياسة أمان المحتوى {#content-security-policy-violations}

تتطلب مجموعة أدوات التطوير البرمجية الخاصة بهم وجود إعدادات غير آمنة ومضمنة وتقييم غير آمن في CSP الخاص بك، **مما يجبرك على المساس بأمان موقعك**.

### فوضى التوثيق {#documentation-chaos}

وقد اعترف مارك ستيوارت بنفسه:

اتفقنا على وجود عدد هائل من واجهات برمجة التطبيقات القديمة والجديدة. من الصعب جدًا العثور على ما نبحث عنه (حتى بالنسبة لنا نحن العاملين هنا).

### ثغرات أمنية {#security-vulnerabilities}

**تطبيق المصادقة الثنائية (2FA) من PayPal معكوس**. حتى مع تفعيل تطبيقات TOTP، فإنها تفرض التحقق عبر الرسائل النصية، مما يجعل الحسابات عرضة لهجمات تبديل بطاقة SIM. إذا كانت ميزة TOTP مفعلة لديك، فيجب استخدامها حصريًا. الحل البديل هو البريد الإلكتروني، وليس الرسائل النصية.

### كارثة إدارة الجلسة {#session-management-disaster}

**لوحة معلومات المطورين تُسجّل خروجك بعد 60 ثانية من عدم النشاط**. حاول القيام بأي شيء مفيد وستجد نفسك تُكرر: تسجيل الدخول ← التحقق من الهوية ← المصادقة الثنائية ← تسجيل الخروج ← التكرار. هل تستخدم VPN؟ بالتوفيق.

## يوليو 2025: القشة الأخيرة {#july-2025-the-final-straw}

بعد ١١ عامًا من نفس المشاكل، وصلت الأمور إلى نقطة الانهيار أثناء عملية نقل حساب روتينية. اضطررنا للانتقال إلى حساب PayPal جديد ليتوافق مع اسم شركتنا "Forward Email LLC" لضمان محاسبة أكثر فعالية.

ما كان من المفترض أن يكون بسيطًا تحول إلى كارثة كاملة:

* أظهرت الاختبارات الأولية أن كل شيء يعمل بشكل صحيح.
* بعد ساعات، أوقفت باي بال فجأة جميع مدفوعات الاشتراك دون إشعار.
* لم يتمكن العملاء من الدفع، مما تسبب في ارتباك وعبء على الدعم.
* قدم دعم باي بال ردودًا متناقضة تدعي التحقق من الحسابات.
* اضطررنا إلى إيقاف مدفوعات باي بال تمامًا.

<figure>
<figcaption><div class="alert alert-danger small text-center">
الخطأ الذي واجهه العملاء عند محاولة الدفع - لا يوجد تفسير، لا سجلات، لا شيء.
</div></figcaption>
<img loading="lazy" src="/img/articles/pypl-something-went-wrong.png" alt="PayPal something went wrong error" class="rounded-lg" />
</figure>

<figure>
<figcaption><div class="alert alert-danger small text-center">
يزعم فريق دعم باي بال أن كل شيء على ما يرام، بينما المدفوعات معطلة تمامًا. تُظهر الرسالة الأخيرة أنهم قالوا إنهم "استعادوا بعض الميزات" لكنهم ما زالوا يطلبون معلومات إضافية غير محددة - دعم باي بال الكلاسيكي.
</div></figcaption>
<img loading="lazy" src="/img/articles/pypl-help-center-1.png" alt="PayPal help center screenshot 1" class="rounded-lg" />
<img loading="lazy" src="/img/articles/pypl-help-center-2.png" alt="PayPal help center screenshot 2" class="rounded-lg" />
<img loading="lazy" src="/img/articles/pypl-help-center-3.png" alt="PayPal help center screenshot 3" class="rounded-lg" />
<img loading="lazy" src="/img/articles/pypl-help-center-4.png" alt="PayPal help center screenshot 4" class="rounded-lg" />
<img loading="lazy" src="/img/articles/pypl-help-center-5.png" alt="PayPal help center screenshot 5" class="rounded-lg" />
<img loading="lazy" src="/img/articles/pypl-help-center-6.png" alt="PayPal help center screenshot 6" class="rounded-lg" />
</figure>

<figure>
<figcaption><div class="alert alert-danger small text-center">
عملية التحقق من الهوية التي يُفترض أنها لم تُصلح شيئًا.
</div></figcaption>
<img loading="lazy" src="/img/articles/pypl-take-care-1.png" alt="PayPal take care screenshot 1" class="rounded-lg" />
<img loading="lazy" src="/img/articles/pypl-take-care-2.png" alt="PayPal take care screenshot 2" class="rounded-lg" />
<img loading="lazy" src="/img/articles/pypl-take-care-3.png" alt="PayPal take care screenshot 3" class="rounded-lg" />
<img loading="lazy" src="/img/articles/pypl-take-care-4.png" alt="PayPal take care screenshot 4" class="rounded-lg" />
<img loading="lazy" src="/img/articles/pypl-take-care-5.png" alt="PayPal take care screenshot 5" class="rounded-lg" />
<img loading="lazy" src="/img/articles/pypl-take-care-6.png" alt="PayPal take care screenshot 6" class="rounded-lg" />
<img loading="lazy" src="/img/articles/pypl-take-care-7.png" alt="PayPal take care screenshot 7" class="rounded-lg" />
</figure>

<figure>
<figcaption><div class="alert alert-danger small text-center">
رسالة غامضة، ولا يوجد حل حتى الآن. لا توجد أي معلومات أو إشعارات أو أي شيء يتعلق بالمعلومات الإضافية المطلوبة. خدمة دعم العملاء صامتة.
</div></figcaption>
<img loading="lazy" src="/img/articles/pypl-restored.png" alt="PayPal restored screenshot" class="rounded-lg" />
</figure>

## لماذا لا يمكننا ببساطة إسقاط PayPal {#why-we-cant-just-drop-paypal}

على الرغم من كل هذه المشاكل، لا يمكننا التخلي تمامًا عن باي بال، لأن بعض العملاء لا يستخدمونه إلا كخيار دفع. وكما ذكر أحد العملاء على [صفحة الحالة](https://github.com/forwardemail/status.forwardemail.net/issues/1658#issuecomment-3026530515):

> PayPal هو خياري الوحيد للدفع

**لقد أصبحنا عالقين في دعم منصة معطلة لأن PayPal أنشأ احتكار الدفع لمستخدمين معينين.**

## الحل البديل للمجتمع {#the-community-workaround}

بما أن باي بال لن يوفر خاصية قائمة الاشتراكات الأساسية، فقد طوّر مجتمع المطورين حلولاً بديلة. أنشأنا نصًا برمجيًا يساعد في إدارة اشتراكات باي بال: [set-active-pypl-subscription-ids.js](https://github.com/forwardemail/forwardemail.net/blob/master/scripts/set-active-pypl-subscription-ids.js)

يشير هذا النص إلى [جوهر المجتمع](https://gist.github.com/titanism/955f0c21d53e8c98068c549fb79e75d4) حيث يتشارك المطورون الحلول. المستخدمون هم في الواقع [شكرنا](https://gist.github.com/titanism/955f0c21d53e8c98068c549fb79e75d4?permalink_comment_id=5045775#gistcomment-5045775) لتوفير ما كان ينبغي على PayPal إنشاؤه منذ سنوات.

## حظر قوالب PayPal بسبب التصيد الاحتيالي {#blocking-paypal-templates-due-to-phishing}

تتجاوز المشاكل واجهات برمجة التطبيقات. فقوالب البريد الإلكتروني في PayPal مصممة بشكل سيء للغاية، مما اضطرنا إلى تطبيق فلترة خاصة في خدمة البريد الإلكتروني لدينا لعدم قدرتها على تمييزها عن محاولات التصيد الاحتيالي.

### المشكلة الحقيقية: قوالب PayPal تبدو وكأنها عمليات احتيال {#the-real-problem-paypals-templates-look-like-scams}

نتلقى بانتظام تقارير عن رسائل بريد إلكتروني من PayPal تبدو تمامًا كمحاولات تصيد احتيالي. إليك مثال حقيقي من تقارير إساءة الاستخدام لدينا:

**الموضوع:** `[Sandbox] TEST - New invoice from PaypalBilling434567 sandbox #A4D369E8-0001`

أُعيد توجيه هذا البريد الإلكتروني إلى `abuse@microsoft.com` لأنه بدا وكأنه محاولة تصيد احتيالي. المشكلة؟ في الواقع، كان من بيئة باي بال التجريبية، ولكن تصميم قالبهم رديء جدًا لدرجة أنه يُفعّل أنظمة كشف التصيد الاحتيالي.

### تنفيذنا {#our-implementation}

يمكنك رؤية التصفية الخاصة بـ PayPal التي تم تنفيذها في [كود تصفية البريد الإلكتروني](https://github.com/forwardemail/forwardemail.net/blob/3b45c70391b5b572b2568749d71be3f7198cd995/helpers/is-arbitrary.js#L151-L172):

```javascript
// check for paypal scam (very strict until PayPal resolves phishing on their end)
// (seems to only come from "outlook.com" and "paypal.com" hosts)
//
// X-Email-Type-Id = RT000238
// PPC001017
// RT000542 = gift message hack
// RT002947 = paypal invoice spam
// <https://www.bleepingcomputer.com/news/security/beware-paypal-new-address-fraud/>
//
if (
  session.originalFromAddressRootDomain === 'paypal.com' &&
  headers.hasHeader('x-email-type-id') &&
  ['PPC001017', 'RT000238', 'RT000542', 'RT002947'].includes(
    headers.getFirst('x-email-type-id')
  )
) {
  const err = new SMTPError(
    'Due to ongoing PayPal invoice spam, you must manually send an invoice link'
  );
  err.isCodeBug = true; // alert admins for inspection
  throw err;
}
```

### لماذا كان علينا حظر PayPal {#why-we-had-to-block-paypal}

طبّقنا هذا لأن باي بال رفضت إصلاح مشاكل البريد العشوائي/التصيد الاحتيالي/الاحتيال الهائلة، رغم تقاريرنا المتكررة لفرق إساءة الاستخدام. تشمل أنواع البريد الإلكتروني التي نحظرها ما يلي:

* **RT000238** - إشعارات فواتير مشبوهة
* **PPC001017** - تأكيدات دفع إشكالية
* **RT000542** - محاولات اختراق رسائل الهدايا

### مقياس المشكلة {#the-scale-of-the-problem}

تُظهر سجلات تصفية البريد العشوائي لدينا حجمًا هائلًا من رسائل فواتير PayPal العشوائية التي نعالجها يوميًا. من أمثلة الرسائل المحظورة:

* "فاتورة من فريق فوترة باي بال: سيتم خصم هذه الرسوم تلقائيًا من حسابك. يُرجى التواصل معنا فورًا على الرقم [PHONE]"
* "فاتورة من [COMPANY NAME] (رقم الطلب])"
* نسخ متعددة بأرقام هواتف مختلفة ومعرفات طلبات مزيفة

غالبًا ما تأتي هذه الرسائل الإلكترونية من مضيفين `outlook.com`، ولكن يبدو أنها صادرة من أنظمة PayPal الشرعية، مما يجعلها خطيرة للغاية. تجتاز هذه الرسائل مصادقة SPF وDKIM وDMARC لأنها تُرسل عبر البنية التحتية الفعلية لـ PayPal.

تُظهر سجلاتنا الفنية أن رسائل البريد الإلكتروني العشوائية هذه تحتوي على رؤوس PayPal شرعية:

* `X-Email-Type-Id: RT000238` (نفس المعرف الذي حظرناه)
* `From: "service@paypal.com" <service@paypal.com>`
* توقيعات DKIM صالحة من `paypal.com`
* سجلات SPF صحيحة تُظهر خوادم بريد PayPal

يؤدي هذا إلى إنشاء موقف مستحيل: رسائل البريد الإلكتروني المشروعة من PayPal والرسائل العشوائية لها نفس الخصائص التقنية.

### المفارقة {#the-irony}

باي بال، الشركة التي يُفترض أن تقود مكافحة الاحتيال المالي، لديها قوالب بريد إلكتروني سيئة التصميم لدرجة أنها تُفعّل أنظمة مكافحة التصيد الاحتيالي. نحن مُضطرون لحظر رسائل باي بال الإلكترونية الموثوقة لأنها لا تُميز عن عمليات الاحتيال.

تم توثيق ذلك في بحث أمني: [احذر من عملية الاحتيال عبر عنوان PayPal الجديد](https://www.bleepingcomputer.com/news/security/beware-paypal-new-address-feature-abused-to-send-phishing-emails/) - يوضح كيفية استغلال أنظمة PayPal الخاصة في عمليات الاحتيال.

### التأثير الحقيقي: عمليات احتيال جديدة على PayPal {#real-world-impact-novel-paypal-scams}

لا تقتصر المشكلة على سوء تصميم القالب فحسب. فنظام الفواتير في باي بال سهل الاستغلال لدرجة أن المحتالين يستغلونه بانتظام لإرسال فواتير مزورة تبدو شرعية. وثّق الباحث الأمني جافين أنديريج ثغرة [عملية احتيال جديدة على PayPal](https://anderegg.ca/2023/02/01/a-novel-paypal-scam)، حيث يرسل المحتالون فواتير باي بال حقيقية تجتاز جميع اختبارات المصادقة.

عند فحص المصدر، بدا أن البريد الإلكتروني صادر من PayPal (جميعها مُعتمدة من SPF وDKIM وDMARC). كما ارتبط الزر برابط بدا وكأنه رابط PayPal شرعي... استغرق الأمر ثانيةً لأدرك أنه بريد إلكتروني شرعي. لقد تلقيتُ للتو "فاتورة" عشوائية من مُحتال.

<figure>
<figcaption><div class="alert alert-danger small text-center">
لقطة شاشة تُظهر فواتير باي بال احتيالية متعددة تغمر صندوق الوارد، وتبدو جميعها شرعية لأنها في الواقع صادرة من أنظمة باي بال.
</div></figcaption>
<img loading="lazy" src="/img/articles/pypl-paypal-scam.png" alt="PayPal scam warning screenshot" class="rounded-lg" />
</figure>

وأشار الباحث إلى:

يبدو أيضًا أنها ميزة مريحة ينبغي على باي بال التفكير في إلغائها. افترضتُ فورًا أنها عملية احتيال، وكنتُ مهتمًا فقط بالتفاصيل التقنية. يبدو الأمر سهلًا للغاية، وأخشى أن ينخدع به الآخرون.

وهذا يوضح المشكلة تمامًا: فالأنظمة المشروعة الخاصة بشركة PayPal مصممة بشكل سيئ للغاية لدرجة أنها تمكن من الاحتيال وفي الوقت نفسه تجعل الاتصالات المشروعة تبدو مشبوهة.

ولجعل الأمور أسوأ، أثر هذا على قدرتنا على توصيل منتجاتنا إلى ياهو، مما أدى إلى شكاوى العملاء وساعات من الاختبارات الدقيقة والتحقق من الأنماط.

## عملية KYC العكسية من PayPal {#paypals-backwards-kyc-process}

من أكثر الجوانب المُحبطة في منصة باي بال هو نهجها المُتخلف في الامتثال وإجراءات معرفة العميل (KYC). فعلى عكس مُعالجات الدفع الأخرى، تُتيح باي بال للمطورين دمج واجهات برمجة التطبيقات الخاصة بهم والبدء في تحصيل المدفوعات في مرحلة الإنتاج قبل إتمام عملية التحقق اللازمة.

### كيف ينبغي أن يعمل {#how-it-should-work}

يتبع كل معالج دفع شرعي التسلسل المنطقي التالي:

١. **أكمل عملية التحقق من هوية العميل (KYC) أولاً**
٢. **وافق على حساب التاجر**
٣. **وفر وصولاً إلى واجهة برمجة التطبيقات الإنتاجية**
٤. **اسمح بتحصيل المدفوعات**

يؤدي هذا إلى حماية معالج الدفع والتاجر من خلال ضمان الامتثال قبل تحويل أي أموال.

### كيف يعمل PayPal فعليًا {#how-paypal-actually-works}

عملية PayPal هي عملية معكوسة تمامًا:

١. **توفير وصول فوري إلى واجهة برمجة التطبيقات الإنتاجية**
٢. **السماح بتحصيل المدفوعات لساعات أو أيام**
٣. **حظر المدفوعات فجأةً دون إشعار**
٤. **اطلب توثيق "اعرف عميلك" بعد تأثر العملاء بالفعل**
٥. **عدم إخطار التاجر**
٦. **السماح للعملاء باكتشاف المشكلة والإبلاغ عنها**

### التأثير الحقيقي في العالم {#the-real-world-impact}

تؤدي هذه العملية العكسية إلى خلق كوارث للشركات:

* **لا يمكن للعملاء إتمام عمليات الشراء** خلال فترات ذروة المبيعات
* **لا يوجد تحذير مسبق** بضرورة التحقق
* **لا توجد إشعارات عبر البريد الإلكتروني** عند حظر المدفوعات
* **يعلم التجار بالمشاكل من العملاء المرتبكين**
* **خسارة في الإيرادات** خلال فترات العمل الحرجة
* **تضرر ثقة العملاء** عند فشل المدفوعات بشكل غامض

### كارثة ترحيل الحسابات في يوليو 2025 {#the-july-2025-account-migration-disaster}

حدث هذا السيناريو بالضبط أثناء عملية نقل حساباتنا الروتينية في يوليو ٢٠٢٥. سمح باي بال في البداية بالدفع، ثم أوقفه فجأةً دون أي إشعار. لم نكتشف المشكلة إلا عندما بدأ العملاء بالإبلاغ عن عدم قدرتهم على الدفع.

عند تواصلنا مع فريق الدعم، تلقينا ردودًا متناقضة حول المستندات المطلوبة، دون تحديد جدول زمني واضح للحل. هذا أجبرنا على إيقاف مدفوعات PayPal تمامًا، مما أربك العملاء الذين لم تكن لديهم خيارات دفع أخرى.

### لماذا هذا مهم؟ {#why-this-matters}

يُظهر نهج باي بال للامتثال سوء فهمٍ جوهريٍّ لكيفية عمل الشركات. ينبغي أن يتمّ تطبيق إجراءات "اعرف عميلك" الصحيحة **قبل** دمج الإنتاج، وليس بعد بدء العملاء في الدفع. ويُظهر غياب التواصل الاستباقي عند ظهور المشاكل انفصال باي بال عن احتياجات التجار.

إن هذه العملية العكسية هي أحد أعراض المشاكل التنظيمية الأوسع نطاقاً التي تعاني منها شركة PayPal: حيث إنها تعطي الأولوية لعملياتها الداخلية على تجربة التاجر والعملاء، مما يؤدي إلى نوع الكوارث التشغيلية التي تدفع الشركات بعيداً عن منصتها.

## كيف يقوم كل معالج دفع آخر بذلك بشكل صحيح {#how-every-other-payment-processor-does-it-right}

وظيفة قائمة الاشتراكات التي يرفض باي بال تطبيقها كانت معيارية في هذا المجال لأكثر من عقد. إليك كيفية تعامل معالجات الدفع الأخرى مع هذا المطلب الأساسي:

### شريط {#stripe}

لدى Stripe قائمة اشتراكات منذ إطلاق واجهة برمجة التطبيقات الخاصة بها. توضح وثائقها بوضوح كيفية استرداد جميع الاشتراكات لحساب العميل أو التاجر. تُعتبر هذه وظيفة أساسية في CRUD.

### مجداف {#paddle}

توفر Paddle واجهات برمجة تطبيقات شاملة لإدارة الاشتراكات، بما في ذلك الإدراج والتصفية والترقيم. فهم يدركون حاجة التجار إلى الاطلاع على مصادر إيراداتهم المتكررة.

حامل مكان مؤقت 0 كوين بيس كوميرس {حامل مكان مؤقت 1}

حتى معالجات دفع العملات المشفرة مثل Coinbase Commerce توفر إدارة اشتراك أفضل من PayPal.

### مربع {#square}

تتضمن واجهة برمجة التطبيقات الخاصة بـ Square قائمة الاشتراك باعتبارها ميزة أساسية، وليس مجرد فكرة ثانوية.

### المعيار الصناعي {#the-industry-standard}

يوفر كل معالج دفع حديث ما يلي:

* عرض جميع الاشتراكات
* تصفية حسب الحالة والتاريخ والعميل
* ترقيم الصفحات لمجموعات البيانات الكبيرة
* إشعارات الويب هوك لتغييرات الاشتراك
* توثيق شامل مع أمثلة عملية

### ما تقدمه المعالجات الأخرى مقابل PayPal {#what-other-processors-provide-vs-paypal}

**Stripe - قائمة بجميع الاشتراكات:**

```http
GET https://api.stripe.com/v1/subscriptions
Authorization: Bearer sk_test_...

Response:
{
  "object": "list",
  "data": [
    {
      "id": "sub_1MowQVLkdIwHu7ixeRlqHVzs",
      "object": "subscription",
      "status": "active",
      "customer": "cus_Na6dX7aXxi11N4",
      "current_period_start": 1679609767,
      "current_period_end": 1682288167
    }
  ],
  "has_more": false
}
```

**Stripe - تصفية حسب العميل:**

```http
GET https://api.stripe.com/v1/subscriptions?customer=cus_Na6dX7aXxi11N4
```

**شريط - تصفية حسب الحالة:**

```http
GET https://api.stripe.com/v1/subscriptions?status=active
```

**PayPal - ما تحصل عليه فعليًا:**

```http
GET https://api.paypal.com/v1/billing/subscriptions/{id}
Authorization: Bearer access_token

# You can ONLY get ONE subscription if you already know the ID
# There is NO endpoint to list all subscriptions
# There is NO way to search or filter
# You must track all subscription IDs yourself
```

**نقاط النهاية المتاحة لـ PayPal:**

* `POST /v1/billing/subscriptions` - إنشاء اشتراك
* `GET /v1/billing/subscriptions/{id}` - الحصول على اشتراك واحد (إذا كنت تعرف المعرف)
* `PATCH /v1/billing/subscriptions/{id}` - تحديث اشتراك
* `POST /v1/billing/subscriptions/{id}/cancel` - إلغاء الاشتراك
* `POST /v1/billing/subscriptions/{id}/suspend` - تعليق الاشتراك

**ما هو المفقود في PayPal:**

* ❌ لا يوجد `GET /v1/billing/subscriptions` (عرض الكل)
* ❌ لا توجد خاصية بحث
* ❌ لا توجد تصفية حسب الحالة، العميل، التاريخ
* ❌ لا يوجد دعم للترقيم

PayPal هو معالج الدفع الرئيسي الوحيد الذي يجبر المطورين على تتبع معرفات الاشتراك يدويًا في قواعد بياناتهم الخاصة.

## التستر المنهجي من قِبل PayPal: إسكات 6 ملايين صوت {#paypals-systematic-cover-up-silencing-6-million-voices}

في خطوة تجسد تمامًا نهج PayPal في التعامل مع الانتقادات، قاموا مؤخرًا بإغلاق منتدى مجتمعهم بالكامل، مما أدى فعليًا إلى إسكات أكثر من 6 ملايين عضو ومحو مئات الآلاف من المنشورات التي توثق إخفاقاتهم.

### المحو العظيم {#the-great-erasure}

استضاف مجتمع باي بال الأصلي في `paypal-community.com` **6,003,558 عضوًا**، وتضمن مئات الآلاف من المنشورات وتقارير الأخطاء والشكاوى والمناقشات حول أعطال واجهة برمجة تطبيقات باي بال. ويمثل هذا أكثر من عقد من الأدلة الموثقة على مشاكل باي بال المنهجية.

في 30 يونيو 2025، أوقفت باي بال المنتدى بأكمله بهدوء. جميع روابط `paypal-community.com` تُظهر الآن أخطاء 404. لم يكن هذا نقلاً أو ترقية.

### عملية الإنقاذ من جهة خارجية {#the-third-party-rescue}

لحسن الحظ، قامت خدمة خارجية على [ppl.lithium.com](https://ppl.lithium.com/) بحفظ بعض المحتوى، مما سمح لنا بالوصول إلى المناقشات التي حاولت PayPal إخفاءها. مع ذلك، فإن هذه الخدمة الخارجية غير مكتملة وقد تختفي في أي وقت.

هذا النمط من إخفاء الأدلة ليس جديدًا على باي بال. فلديهم تاريخ موثق في:

* إزالة تقارير الأخطاء الحرجة من العرض العام
* إيقاف أدوات المطورين دون إشعار
* تغيير واجهات برمجة التطبيقات دون توثيق مناسب
* إسكات نقاشات المجتمع حول إخفاقاتها

إن إغلاق المنتدى يمثل المحاولة الأكثر وقاحة حتى الآن لإخفاء إخفاقاتهم المنهجية عن التدقيق العام.

## كارثة خطأ الالتقاط التي استمرت 11 عامًا: 1899 دولارًا أمريكيًا وما زال العدد في ازدياد {#the-11-year-capture-bug-disaster-1899-and-counting}

بينما كانت باي بال منشغلة بتنظيم جلسات التقييم وتقديم الوعود، كان نظام معالجة المدفوعات الأساسي لديها معطلاً بشكل جذري لأكثر من 11 عامًا. والدليل على ذلك كارثي.

### خسارة 1,899 دولارًا أمريكيًا في رسائل البريد الإلكتروني الموجهة إلى {#forward-emails-1899-loss}

في أنظمة الإنتاج لدينا، اكتشفنا 108 مدفوعات PayPal بقيمة إجمالية **1,899 دولارًا أمريكيًا** ضاعت بسبب فشل تسجيل PayPal. تُظهر هذه المدفوعات نمطًا ثابتًا:

* تم استلام خطافات ويب `CHECKOUT.ORDER.APPROVED`
* أعادت واجهة برمجة تطبيقات PayPal أخطاء 404
* أصبحت الطلبات غير قابلة للوصول عبر واجهة برمجة تطبيقات PayPal

من المستحيل تحديد ما إذا كان قد تم فرض رسوم على العملاء نظرًا لأن PayPal يخفي سجلات التصحيح تمامًا بعد 14 يومًا ويمحو جميع البيانات من لوحة المعلومات لمعرفات الطلبات التي لم يتم التقاطها.

هذا يمثل نشاطًا تجاريًا واحدًا فقط. **من المرجح أن تبلغ الخسائر الإجمالية لآلاف التجار على مدى أكثر من ١١ عامًا ملايين الدولارات.**

**سنكرر ذلك مرة أخرى: الخسائر الجماعية لآلاف التجار على مدى أكثر من 11 عامًا من المرجح أن تصل إلى ملايين الدولارات.**

السبب الوحيد وراء اكتشافنا لهذا هو أننا دقيقون للغاية ومدفوعون بالبيانات.

### التقرير الأصلي لعام 2013: أكثر من 11 عامًا من الإهمال {#the-2013-original-report-11-years-of-negligence}

يظهر أقدم تقرير موثق لهذه المشكلة بالضبط في [Stack Overflow في نوفمبر 2013](https://stackoverflow.com/questions/19773755/keep-receiving-404-error-with-rest-api-when-doing-a-capture) ([مؤرشفة](https://web.archive.org/web/20250708045416/https://stackoverflow.com/questions/19773755/keep-receiving-404-error-with-rest-api-when-doing-a-capture)):

> "استمر في تلقي خطأ 404 مع واجهة برمجة التطبيقات Rest API عند إجراء عملية التقاط"

الخطأ الذي تم الإبلاغ عنه في عام 2013 هو **متطابق** مع ما حدث في Forward Email في عام 2024:

```json
{
  "name": "INVALID_RESOURCE_ID",
  "message": "The requested resource ID was not found",
  "information_link": "https://developer.paypal.com/webapps/developer/docs/api/#INVALID_RESOURCE_ID",
  "debug_id": "e56bae98dcc26"
}
```

وكانت استجابة المجتمع في عام 2013 مثيرة للاهتمام:

> "هناك مشكلة تم الإبلاغ عنها في الوقت الحالي مع واجهة برمجة التطبيقات REST. يعمل PayPal على حلها."

**بعد مرور أكثر من 11 عامًا، ما زالوا "يعملون على ذلك".**

### اعتراف عام 2016: PayPal يكسر مجموعة أدوات التطوير البرمجية الخاصة به {#the-2016-admission-paypal-breaks-their-own-sdk}

في عام ٢٠١٦، وثّق مستودع GitHub الخاص بشركة PayPal تأثير [فشل كبير في الالتقاط](https://github.com/paypal/PayPal-PHP-SDK/issues/660) على مجموعة تطوير البرامج PHP الرسمية الخاصة بها. وكان حجم المشكلة مذهلاً:

منذ 20/9/2016، فشلت جميع محاولات التقاط بيانات باي بال مع ظهور الخطأ 'INVALID_RESOURCE_ID - لم يتم العثور على معرف المورد المطلوب'. لم يتغير شيء بين 19/9 و20/9 في تكامل واجهة برمجة التطبيقات. **أعادت 100% من محاولات التقاط البيانات منذ 20/9 هذا الخطأ.**

وأفاد أحد التجار:

> "لقد واجهت **أكثر من 1400 محاولة التقاط فاشلة خلال الـ 24 ساعة الماضية**، وكلها كانت مصحوبة باستجابة خطأ INVALID_RESOURCE_ID."

كان رد باي بال الأولي هو إلقاء اللوم على التاجر وإحالته إلى الدعم الفني. ولم يعترفوا بالخطأ إلا بعد ضغوط هائلة.

تلقيتُ تحديثًا من مطوري منتجاتنا. لاحظوا في العناوين المرسلة أن مُعرّف طلب PayPal يُرسل بـ 42 حرفًا، ولكن **يبدو أن تغييرًا حدث مؤخرًا يحدّ من هذا المُعرّف إلى 38 حرفًا فقط.**

يكشف هذا الاعتراف عن الإهمال المنهجي لشركة PayPal:

١. **أجروا تغييرات غير موثقة، مما أدى إلى تعطل حزمة تطوير البرامج الرسمية الخاصة بهم**
٢. **أعطّلوا حزمة تطوير البرامج الرسمية الخاصة بهم**
٣. **ألقوا اللوم على التجار أولاً**
٤. **لم يعترفوا بالخطأ إلا تحت الضغط**

حتى بعد "إصلاح" المشكلة، أبلغ التجار عن:

> "تم ترقية SDK إلى الإصدار 1.7.4 و**لا تزال المشكلة قائمة.**"

### التصعيد في عام 2024: لا يزال مكسورًا {#the-2024-escalation-still-broken}

تُظهر التقارير الأخيرة من مجتمع باي بال المُحافظ عليه أن المشكلة قد تفاقمت. يُوثّق [مناقشة سبتمبر 2024](https://ppl.lithium.com/t5/REST-APIs/Receiving-APPROVED-Webhooks-for-Order-but-capture-leads-to-404/td-p/3176093) ([مؤرشفة](https://web.archive.org/web/20250708045416/https://ppl.lithium.com/t5/REST-APIs/Receiving-APPROVED-Webhooks-for-Order-but-capture-leads-to-404/td-p/3176093)) نفس المشاكل تمامًا:

بدأت المشكلة بالظهور منذ أسبوعين فقط، ولا تؤثر على جميع الطلبات. **يبدو أن المشكلة الأكثر شيوعًا هي أخطاء 404 عند التقاط الطلب.**

يصف التاجر نفس النمط الذي واجهته خدمة إعادة توجيه البريد الإلكتروني:

> "بعد محاولة التقاط الطلب، يُرجع PayPal خطأ 404. عند استرداد تفاصيل الطلب: {'id': 'ID', 'intent': 'CAPTURE', 'status': 'COMPLETED', ..., 'final_capture': true, ...} **هذا بدون أي أثر لالتقاط ناجح من جانبنا.**"

### كارثة موثوقية Webhook {#the-webhook-reliability-disaster}

يكشف [مناقشة المجتمع المحفوظة](https://ppl.lithium.com/t5/REST-APIs/Not-received-PAYMENT-CAPTURE-COMPLETED-when-had-captured/m-p/3042446) آخر أن نظام webhook الخاص بـ PayPal غير موثوق به بشكل أساسي:

> "نظريًا، يجب أن يتضمن حدثين (CHECKOUT.ORDER.APPROVED وPAYMENT.CAPTURE.COMPLETED) من حدث Webhook. في الواقع، **نادرًا ما يتم استلام هذين الحدثين فورًا، حيث لا يمكن استلام PAYMENT.CAPTURE.COMPLETED في معظم الأحيان أو قد يتم استلامه خلال بضع ساعات.**"

لمدفوعات الاشتراك:

> "لم يتم استلام ""PAYMENT.SALE.COMPLETED"" في بعض الأحيان أو حتى بعد بضع ساعات.**"

تكشف أسئلة التاجر عن عمق مشاكل موثوقية PayPal:

١. **"لماذا يحدث هذا؟"** - نظام ويب هوك الخاص بباي بال معطل تمامًا.
٢. **"إذا كانت حالة الطلب "مكتمل"، فهل أفترض أنني استلمت المبلغ؟"** - لا يمكن للتجار الوثوق باستجابات واجهة برمجة تطبيقات باي بال.
٣. **"لماذا لا يمكن لـ "سجلات الأحداث -> أحداث ويب هوك" العثور على أي سجلات؟"** - حتى نظام تسجيل باي بال نفسه لا يعمل.

### نمط الإهمال المنهجي {#the-pattern-of-systematic-negligence}

وتمتد الأدلة على مدى أكثر من 11 عامًا وتُظهر نمطًا واضحًا:

* **٢٠١٣**: "باي بال تعمل على حل المشكلة"
* **٢٠١٦**: باي بال تعترف بتغيير جذري وتقدم حلاً معطلاً
* **٢٠٢٤**: لا تزال الأخطاء نفسها تحدث، مما يؤثر على إعادة توجيه البريد الإلكتروني والعديد من الأخطاء الأخرى

هذا ليس خطأ - **هذا إهمال منهجي.** لقد علمت PayPal بهذه الإخفاقات الحرجة في معالجة الدفع منذ أكثر من عقد من الزمان وقامت باستمرار بما يلي:

١. **إلقاء اللوم على التجار بسبب أخطاء باي بال**
٢. **إجراء تغييرات جذرية غير موثقة**
٣. **تقديم إصلاحات غير كافية وغير فعالة**
٤. **تجاهل التأثير المالي على الشركات**
٥. **إخفاء الأدلة من خلال إغلاق منتديات المجتمع**

### المتطلب غير الموثق {#the-undocumented-requirement}

لا يذكر أيٌّ من وثائق باي بال الرسمية وجوب تطبيق التجار لمنطق إعادة المحاولة لعمليات الالتقاط. تنصّ وثائقهم على وجوب "الالتقاط فور الموافقة"، لكنها لا تذكر أن واجهة برمجة التطبيقات الخاصة بهم تُعيد أخطاء 404 عشوائيًا وتتطلب آليات إعادة محاولة معقدة.

وهذا يفرض على كل تاجر أن:

* تنفيذ منطق إعادة المحاولة للتراجع الأسّي
* معالجة تسليم خطاف الويب غير المتسق
* بناء أنظمة إدارة حالة معقدة
* مراقبة عمليات الالتقاط الفاشلة يدويًا

**يوفر كل معالج دفع آخر واجهات برمجة تطبيقات التقاط موثوقة تعمل في المرة الأولى.**

## نمط الخداع الأوسع نطاقًا لدى PayPal {#paypals-broader-pattern-of-deception}

إن كارثة خطأ الالتقاط ما هي إلا مثال واحد على النهج المنهجي الذي تتبعه شركة PayPal لخداع العملاء وإخفاء إخفاقاتهم.

### إجراء إدارة الخدمات المالية في نيويورك {#the-new-york-department-of-financial-services-action}

في يناير 2025، أصدرت إدارة الخدمات المالية في نيويورك [إجراءات إنفاذ ضد PayPal](https://www.dfs.ny.gov/system/files/documents/2025/01/ea20250123-paypal-inc.pdf) للممارسات الخادعة، مما يدل على أن نمط الخداع الذي تتبعه PayPal يمتد إلى ما هو أبعد من واجهات برمجة التطبيقات الخاصة بها.

يُظهر هذا الإجراء التنظيمي استعداد PayPal للانخراط في ممارسات خادعة في جميع أنحاء أعمالها، وليس فقط أدوات المطورين الخاصة بها.

### دعوى العسل: إعادة كتابة الروابط التابعة {#the-honey-lawsuit-rewriting-affiliate-links}

أدى استحواذ باي بال على شركة هوني إلى سرقة [دعاوى قضائية تزعم أن Honey تعيد كتابة الروابط التابعة](https://www.theverge.com/2024/12/23/24328767/honey-paypal-lawsuit-affiliate-commission-influencer) عمولات من منشئي المحتوى والمؤثرين. يُمثل هذا شكلاً آخر من أشكال الخداع الممنهج، حيث تستفيد باي بال من خلال إعادة توجيه الإيرادات التي كان من المفترض أن تذهب إلى جهات أخرى.

النمط واضح:

١. **أعطال واجهة برمجة التطبيقات**: إخفاء الوظائف المعطلة، وإلقاء اللوم على التجار.
٢. **إسكات المجتمع**: إزالة أدلة المشاكل.
٣. **الانتهاكات التنظيمية**: الانخراط في ممارسات خادعة.
٤. **سرقة الشركات التابعة**: سرقة العمولات من خلال التلاعب الفني.

### تكلفة إهمال PayPal {#the-cost-of-paypals-negligence}

خسارة شركة Forward Email البالغة 1,899 دولارًا أمريكيًا ليست سوى غيض من فيض. تأمل التأثير الأوسع:

* **التجار الأفراد**: آلاف يخسرون مئات إلى آلاف الدولارات لكل منهم.* **عملاء المؤسسات**: خسائر محتملة في الإيرادات بملايين الدولارات.* **وقت المطور**: ساعات لا تُحصى في بناء حلول بديلة لواجهات برمجة تطبيقات PayPal المعطوبة.* **ثقة العملاء**: الشركات تفقد عملاءها بسبب فشل PayPal في الدفع.

إذا خسرت إحدى خدمات البريد الإلكتروني الصغيرة ما يقرب من 2000 دولار، وكانت هذه المشكلة موجودة منذ أكثر من 11 عامًا مما أثر على آلاف التجار، فمن المرجح أن يصل إجمالي الأضرار المالية إلى مئات الملايين من الدولارات.

### كذبة التوثيق {#the-documentation-lie}

غالبًا ما تغفل وثائق PayPal الرسمية عن ذكر القيود والأخطاء الحرجة التي قد يواجهها التجار. على سبيل المثال:

* **واجهة برمجة تطبيقات الالتقاط**: لم يُذكر أن أخطاء 404 شائعة وتتطلب منطق إعادة المحاولة.
* **موثوقية خطاف الويب**: لم يُذكر أن خطافات الويب غالبًا ما تتأخر لساعات.
* **قائمة الاشتراك**: تُشير الوثائق إلى إمكانية إدراجها في حال عدم وجود نقطة نهاية.
* **مهلة الجلسة**: لم يُذكر مهلة زمنية مُرهقة مدتها 60 ثانية.

ويؤدي هذا الإغفال المنهجي للمعلومات الهامة إلى إجبار التجار على اكتشاف حدود PayPal من خلال التجربة والخطأ في أنظمة الإنتاج، مما يؤدي في كثير من الأحيان إلى خسائر مالية.

## ماذا يعني هذا للمطورين {#what-this-means-for-developers}

يُظهر فشل باي بال المنهجي في تلبية احتياجات المطورين الأساسية، مع جمع ملاحظات موسعة، مشكلة تنظيمية جوهرية. فهم يتعاملون مع جمع الملاحظات كبديل عن حل المشكلات فعليًا.

النمط واضح:

١. يُبلغ المطورون عن المشكلات
٢. تُنظم باي بال جلسات تقييم مع المديرين التنفيذيين
٣. تُقدم ملاحظات شاملة
٤. تُقر الفرق بوجود ثغرات وتتعهد بـ"متابعتها ومعالجتها"
٥. لا يُنفذ أي شيء
٦. يغادر المديرون التنفيذيون إلى شركات أفضل
٧. تطلب الفرق الجديدة نفس الملاحظات
٨. تتكرر الدورة

وفي الوقت نفسه، يضطر المطورون إلى بناء حلول بديلة، وتسوية الأمان، والتعامل مع واجهات مستخدم معطلة فقط لقبول المدفوعات.

إذا كنت تُنشئ نظام دفع، فتعلّم من تجربتنا: أنشئ [نهج ثلاثي](https://forwardemail.net/en/blog/docs/building-reliable-payment-system-stripe-paypal) باستخدام معالجات متعددة، ولكن لا تتوقع من PayPal توفير الوظائف الأساسية التي تحتاجها. خطط لبناء حلول بديلة منذ البداية.

يوثّق هذا المنشور خبرتنا الممتدة لأحد عشر عامًا مع واجهات برمجة تطبيقات PayPal في Forward Email. جميع أمثلة الأكواد والروابط مأخوذة من أنظمة الإنتاج الفعلية لدينا. نواصل دعم مدفوعات PayPal على الرغم من هذه المشاكل، لأن بعض العملاء لا يملكون خيارًا آخر.

<img loading="lazy" src="/img/articles/paypal-api-issues.webp" alt="PayPal API disaster illustration" class="rounded-lg" />